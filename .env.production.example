# ============================================
# PRODUCTION ENVIRONMENT VARIABLES
# ============================================
# File này là template cho Coolify deployment
# Copy các biến này vào Coolify Environment Variables

# ============================================
# SERVER
# ============================================
PORT=3000
HOST=0.0.0.0
NODE_ENV=production

# ============================================
# DATABASE
# ============================================
# Coolify tự động inject DATABASE_URL
# DATABASE_URL=postgres://user:pass@host:5432/dbname

# ============================================
# AUTHENTICATION
# ============================================
JWT_SECRET=your_super_secret_jwt_key_change_me_in_production
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=your_refresh_secret_key_change_me_too
JWT_REFRESH_EXPIRES_IN=30d

# ============================================
# MEDIAMTX PROXY CONFIGURATION
# ============================================
# MediaMTX Host - Use service name if in Docker Compose, or localhost if same container
# If MediaMTX runs as separate service: MEDIAMTX_HOST=mediamtx
# If MediaMTX runs in same container: MEDIAMTX_HOST=localhost
MEDIAMTX_HOST=stream.iotek.tn

# MediaMTX API URL - For dynamic camera registration (Solution 1)
# Internal: http://localhost:9997 (if same network)
# External: http://stream.iotek.tn:9997 (if different server)
MEDIAMTX_API_URL=http://stream.iotek.tn:9997

# MediaMTX Ports
MEDIAMTX_RTSP_PORT=8554
MEDIAMTX_HLS_PORT=8888
MEDIAMTX_WEBRTC_PORT=8889

# Use HTTPS for client URLs (browser, mobile)
# Set to true if behind Nginx with SSL
MEDIAMTX_USE_HTTPS=false

# ============================================
# CLOUDFLARE R2 STORAGE
# ============================================
# R2 API Endpoint (from Cloudflare Dashboard → R2 → Bucket Settings)
R2_ENDPOINT=https://a1000a80a775f57fe92ea14196486a3a.r2.cloudflarestorage.com

# R2 API Credentials (from Cloudflare Dashboard → R2 → Manage R2 API Tokens)
R2_ACCESS_KEY_ID=0c10ee4c19fe892894a9c5311798a69c
R2_SECRET_ACCESS_KEY=20db186ea3ebb14ba05254a9b82b1f033fef297335ab8d4e7874e90634ca36bb

# R2 Bucket Name
R2_BUCKET_NAME=iotek

# R2 Public URL - REQUIRED for browser access
# Option 1: Custom Domain (Recommended for production)
R2_PUBLIC_URL=https://iotek.tn-cdn.net
# Option 2: R2.dev Subdomain (Free - enable on Cloudflare Dashboard)
# R2_PUBLIC_URL=https://pub-your-subdomain.r2.dev

# Storage mode: 'r2' (cloud) hoặc 'local' (filesystem)
STORAGE_MODE=r2

# ============================================
# SNAPSHOT CONFIGURATION
# ============================================
# Directory cho temp files (trước khi upload R2)
# ⚠️ LINUX PATH cho production (không phải Windows path C:\\tmp)
SNAPSHOT_DIR=/tmp

# Timeout cho snapshot capture (milliseconds)
SNAPSHOT_TIMEOUT_MS=10000

# FFmpeg analyzeduration (microseconds)
SNAPSHOT_ANALYZE_US=500000

# FFmpeg probesize (bytes)
SNAPSHOT_PROBESIZE=500000

# Fallback to UDP if TCP fails
SNAPSHOT_FALLBACK_UDP=1

# Auto-cache working RTSP URL to database
SNAPSHOT_CACHE_RTSP=1

# Override existing RTSP URL when caching
SNAPSHOT_CACHE_OVERRIDE=0

# Hard timeout for FFmpeg watchdog (milliseconds)
SNAPSHOT_HARD_TIMEOUT_MS=15000

# Debug logging - ⚠️ TẮT trên production
DEBUG_SNAPSHOT=0

# ============================================
# RECORDING CONFIGURATION
# ============================================
# Directory cho temp files (trước khi upload R2)
# ⚠️ LINUX PATH cho production
RECORD_DIR=/tmp

# Debug logging - ⚠️ TẮT trên production
DEBUG_RECORDING=0

# ============================================
# PTZ CONFIGURATION
# ============================================
# Use ONVIF protocol (1) or HTTP API (0)
# Set to 0 if production server cannot reach camera network
PTZ_USE_ONVIF=0

# PTZ command throttle (milliseconds)
PTZ_THROTTLE_MS=300

# PTZ throttle debug logging
PTZ_THROTTLE_DEBUG=0

# ============================================
# STREAMING
# ============================================
# ⚠️ CHANGE THIS - Use your production domain
STREAM_BASE_URL=https://your-production-domain.com/live

# ============================================
# FAKE STRATEGIES (FOR TESTING)
# ============================================
# Size for fake snapshot (width x height)
FAKE_SNAPSHOT_SIZE=1280x720

# Quality for fake snapshot (2=high, 31=low)
FAKE_SNAPSHOT_QUALITY=2

# Background color for fake snapshot
FAKE_SNAPSHOT_BG=black

# Size for fake recording
FAKE_RECORD_SIZE=1280x720

# FPS for fake recording
FAKE_RECORD_FPS=15

# Codec for fake recording
FAKE_RECORD_CODEC=libx264

# CRF quality (lower=better, 18-28 recommended)
FAKE_RECORD_QUALITY=23

# Realtime playback (1=yes, 0=no)
FAKE_RECORD_REALTIME=1

# ============================================
# REFRESH TOKEN DEBUG
# ============================================
REFRESH_DEBUG=0
